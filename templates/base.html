<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Personal Blog{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  {% if adsense_client %}
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client={{ adsense_client }}" crossorigin="anonymous"></script>
  {% endif %}
</head>
<body class="bg-slate-950 text-slate-100">

  <!-- Header -->
  <header class="border-b border-slate-800 bg-slate-900/60 backdrop-blur">
    <nav class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="{{ url_for('index') }}" class="text-xl font-semibold tracking-tight">ambient.blog</a>
      <div class="flex items-center gap-3">
        {% if current_user.is_authenticated %}
          <a class="px-3 py-1.5 rounded-lg bg-slate-800 hover:bg-slate-700" href="{{ url_for('create_post') }}">Write</a>
          <a class="px-3 py-1.5 rounded-lg bg-slate-800 hover:bg-slate-700" href="{{ url_for('account') }}">Account</a>
          {% if current_user.is_owner %}
            <a class="px-3 py-1.5 rounded-lg bg-indigo-700 hover:bg-indigo-600" href="{{ url_for('admin_dashboard') }}">Admin</a>
          {% endif %}
          <a class="px-3 py-1.5 rounded-lg bg-rose-700 hover:bg-rose-600" href="{{ url_for('logout') }}">Logout</a>
        {% else %}
          <a class="px-3 py-1.5 rounded-lg bg-slate-800 hover:bg-slate-700" href="{{ url_for('login') }}">Login</a>
          <a class="px-3 py-1.5 rounded-lg bg-indigo-700 hover:bg-indigo-600" href="{{ url_for('register') }}">Register</a>
        {% endif %}
      </div>
    </nav>
  </header>

  <!-- Top Banner Ad -->
  {% if current_user.is_authenticated and not current_user.is_subscriber %}
    <div class="adsense mb-6 text-center">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-6936107143401860"
           data-ad-slot="7090524437"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  {% endif %}

  <!-- Main Content -->
  <main class="max-w-5xl mx-auto px-4 py-6">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="space-y-2 mb-4">
          {% for category, msg in messages %}
            <div class="rounded-lg px-4 py-3
              {% if category in ['success'] %} bg-emerald-900/40 border border-emerald-700
              {% elif category in ['warning'] %} bg-amber-900/40 border border-amber-700
              {% elif category in ['danger','error'] %} bg-rose-900/40 border border-rose-700
              {% else %} bg-slate-800 border border-slate-700 {% endif %}">
              {{ msg }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </main>

  <!-- Footer Ad -->
  {% if current_user.is_authenticated and not current_user.is_subscriber %}
    <div class="adsense mt-6 text-center">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-6936107143401860"
           data-ad-slot="7090524437"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  {% endif %}

  <!-- Footer -->
  <footer class="border-t border-slate-800 py-6 text-center text-slate-400">
    <p>&copy; {{ datetime.utcnow().year }} ambient.blog â€” crafted with ðŸ’œ</p>
  </footer>
</body>
</html>
